# Как добавить новый сервис

1. Добавить сервис в docker-compose
2. Добавить DNS-запись в PiHole
3. Добавить в .env секцию с новым сервисом, объявить там переменную с доменным именем
4. Добавить в docker-compose, в контейнеры **traefik** и **authelia** проброс добавленной
   переменной
5. Добавить проксирование к сервису в traefik с использованием добавленной переменной
6. Тестирование доступа к сервису лучше выполнять из режима инкогнито, chrome может что-нибудь
   закешировать.

   Перед тестированием доступа сбросить DNS-кэш у systemd-resolve:

   ```bash
   sudo resolvectl flush-caches
   ```

7. Добавить сервис в **services/authelia/config/configuration.yml**, в раздел
   **access_control** -> **rules**.

   - Если у сервиса нет авторизации, то установить **policy** = **one_factor**.
   - Если у сервиса есть своя авторизация, то установить **policy** = **bypass**.
   - Если у сервиса есть возможность авторизации через внешнего провайдера OAuth2, то
     дополнительно настроить авторизацию через authelia.

8. Добавить сервис на главную страницу homer. Содержимое главной страницы определяется в
   **services/homer/assets/config.yml**.


# Как добавить нового пользователя

Пользователи добавляются через файл **services/authelia/config/users_database.yml**.

Нужно ввести логин, почту и пароль.

Пароль можно сгенерировать командой ...
